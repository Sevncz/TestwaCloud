package com.testwa.core.shell;import org.apache.commons.exec.CommandLine;import org.apache.commons.exec.DefaultExecutor;import org.apache.commons.exec.ExecuteWatchdog;import org.apache.commons.exec.PumpStreamHandler;import java.io.ByteArrayOutputStream;import java.io.IOException;import java.io.UnsupportedEncodingException;/** * @Program: distest * @Description: 支持字符编码设置 * @Author: wen * @Create: 2018-04-17 11:30 **/public class UTF8CommonExecs extends AbstractCommonExecs{    private CommandLine commandLine;    private Boolean isEncode;    private Long timeout = 20000L;    private ByteArrayOutputStream outputStream;    private ByteArrayOutputStream errorStream;    /**     *@Description:     *@Param: [commandLine]     *@Return:     *@Author: wen     *@Date:     */    public UTF8CommonExecs(CommandLine commandLine) {        super(commandLine);        this.commandLine = commandLine;    }    @Override    public boolean supportWatchdog() {        return true;    }    @Override    public ExecuteWatchdog getWatchdog() {        return new ExecuteWatchdog(timeout);    }    public void setTimeout(Long timeout){        this.timeout = timeout;    }    public void unableEncoding() {        isEncode = false;    }    public void ableEncoding() {        isEncode = true;    }    public String getEncoding() {        return "UTF-8";    }    public String getOutput(){        String out = "";        try {            if(outputStream != null){                out = outputStream.toString(getEncoding()); //设置编码            }        } catch (UnsupportedEncodingException e) {            e.printStackTrace();        }        return out;    }    public String getError(){        String error = "";        try {            if(outputStream != null){                error = errorStream.toString(getEncoding()); //设置编码            }        } catch (UnsupportedEncodingException e) {            e.printStackTrace();        }        return error;    }    public void exec() throws IOException {        outputStream = new ByteArrayOutputStream();        errorStream = new ByteArrayOutputStream();        DefaultExecutor executor = new DefaultExecutor();        PumpStreamHandler streamHandler = new PumpStreamHandler(outputStream,errorStream);        executor.setStreamHandler(streamHandler);        executor.execute(this.commandLine);    }}