package com.testwa.distest.client.event;import com.testwa.distest.client.exception.DeviceNotReadyException;import com.testwa.distest.client.service.GrpcClientService;import lombok.extern.slf4j.Slf4j;import org.apache.commons.lang3.StringUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.ApplicationListener;import org.springframework.scheduling.annotation.Async;import org.springframework.stereotype.Component;@Slf4j@Componentpublic class DeviceOnlineListener implements ApplicationListener<DeviceConnectedEvent> {    @Autowired    private GrpcClientService grpcClientService;    @Override    public void onApplicationEvent(DeviceConnectedEvent event) {        log.info("Event: 设备 " + event.getDeviceId() + " 上线");        grpcClientService.deviceOnline(event.getDeviceId());        try {            if(StringUtils.isNotBlank(event.getDeviceId())){                grpcClientService.initDevice(event.getDeviceId());            }        }catch (DeviceNotReadyException e){            log.error("设备 {} 初始化失败", e);        }    }}