package com.testwa.distest.client.callback;import com.google.protobuf.ByteString;import com.testwa.distest.client.DeviceClient;import com.testwa.distest.client.android.ADBCommandUtils;import lombok.extern.slf4j.Slf4j;/** * @Program: distest * @Description: * @Author: wen * @Create: 2018-05-08 20:23 **/@Slf4jpublic class InputCallback implements ICallBack<String> {    private DeviceClient client;    public InputCallback(DeviceClient client){        this.client = client;    }    @Override    public void callback(ByteString bytes) {        String cmd = bytes.toStringUtf8();        log.debug(client+ ":callback-log" + cmd);        if(hasChineseByRange(cmd)) {            ADBCommandUtils.switchADBKeyBoard(client.getClientId());            ADBCommandUtils.inputTextADBKeyBoard(client.getClientId(), cmd, 5000L);        }else{            // 使用stfservice处理非中文字符            client.inputText(cmd);        }    }    /**     * 是否包含汉字<br>     * 根据汉字编码范围进行判断<br>     * CJK统一汉字（不包含中文的，。《》（）“‘’”、！￥等符号）<br>     *     * @param str     * @return     */    private boolean hasChineseByRange(String str) {        if (str == null) {            return false;        }        char[] ch = str.toCharArray();        for (char c : ch) {            if (c >= 0x4E00 && c <= 0x9FBF) {                return true;            }        }        return false;    }}