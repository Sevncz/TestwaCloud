package com.testwa.distest.server.service.rpc;import com.testwa.distest.server.service.rpc.cache.CacheUtil;import com.testwa.distest.server.service.rpc.cache.DefaultClientCache;import com.testwa.distest.server.service.rpc.cache.DefaultTopicService;import com.testwa.distest.server.service.rpc.cache.IClientCache;import io.grpc.stub.StreamObserver;import io.rpc.testwa.device.DeviceServiceGrpc;import io.rpc.testwa.push.*;import lombok.extern.slf4j.Slf4j;import org.lognet.springboot.grpc.GRpcService;import org.springframework.beans.factory.annotation.Autowired;/** * @Program: distest * @Description: pushtest * @Author: wen * @Create: 2018-05-08 15:21 **/@Slf4j@GRpcServicepublic class PushGvice extends PushGrpc.PushImplBase {    @Override    public void registerToServer(ClientInfo request, StreamObserver<Message> responseObserver) {        CacheUtil.serverCache.registerToServer(request, responseObserver);    }    @Override    public void logoutFromServer(ClientInfo request, StreamObserver<Status> responseObserver) {        CacheUtil.serverCache.logoutFromServer(request);    }    @Override    public void subscribe(TopicInfo topicInfo, StreamObserver<Status> responseObserver) {        Status status = CacheUtil.topicCache.subscribeTopic(topicInfo);        responseObserver.onNext(status);        responseObserver.onCompleted();    }    @Override    public void cancel(TopicInfo topicInfo, StreamObserver<Status> responseObserver) {        Status status = CacheUtil.topicCache.cancelTopic(topicInfo);        responseObserver.onNext(status);        responseObserver.onCompleted();    }}