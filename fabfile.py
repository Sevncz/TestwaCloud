#!/usr/bin/env python# -*- coding: utf-8 -*-# @Author: sevncz# @Date:   2016-01-08T12:37:41+08:00# @Last modified by:   sevncz# @Last modified time: 2016-04-12T15:34:27+08:00"""进入文件所在目录，执行fab deploy"""from datetime import datetimefrom util import date_now_string_formatfrom fabric.api import *# ssh 尝试连接的次数env.connection_attempts = 3# 任务并行# env.parallel = True# 目标服务器env.hosts = ['TestwaUser@cloud.testwa.com']@task# @parallel(pool_size=5)def deploy():    """ 部署到生产环境 """    local('mvn package -Dmaven.test.skip=true -Djavacpp.platform=windows-x86_64 ')    # 远程服务器的文件:    remote_tar = '/data/www/server'    run('rm -f %s' % remote_tar)    # 上传tar文件至远程服务器    put('fauth.tar.gz', remote_tar)